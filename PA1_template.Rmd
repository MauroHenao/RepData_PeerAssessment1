---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r}
datos=read.csv("activity.csv",header=T)
head(datos)
```
## What is mean total number of steps taken per day?
The NA values are ignored in this section. The next figure is a histogram with the total number of steps taken daily. 
```{r}
totalsteps=ddply(datos,~date,summarise,steps=sum(steps))
NAtotalsteps=na.omit(totalsteps)
hist(NAtotalsteps$steps,main="Histogram \n Total of steps per day",xlab="steps",col = "lightgray")
```

Next, the mean of total steps taken per day is shown
```{r}
meansteps=ddply(NAtotalsteps,~date,summarise,mean=mean(steps),median=median(steps))
summary(meansteps$mean)
```

 `r meansteps=ddply(NAtotalsteps,~date,summarise,mean=mean(steps),median=median(steps))
summary(meansteps$mean)`

## What is the average daily activity pattern?
```{r}
NAdatos=na.omit(datos)
meaninterval=ddply(NAdatos,~interval,summarise,mean=mean(steps))
plot(meaninterval$interval,meaninterval$mean,type="l" ,main="Time Series\nMean of steps")
meaninterval
maxcol=which.max(meaninterval$mean)
meaninterval[maxcol,]
```
## Imputing missing values
```{r}
NAs=sum(is.na(datos))
NAs
sinna=ddply(datos,"interval",mutate,imputed=impute(steps,mean))
sinnatotalsteps=ddply(sinna,~date,summarise,steps=sum(steps))
hist(sinnatotalsteps$steps,main="Histogram \n Total of steps per day",xlab="steps",col = "lightgray")
sinnameansteps=ddply(sinna,~date,summarise,mean=mean(steps))
summary(sinnameansteps$mean)
summary(sinna$steps)
par(mfrow=c(1,2))
hist(NAtotalsteps$steps,main="Histogram \n Total of steps per day",xlab="steps",col = "lightgray")
hist(sinnatotalsteps$steps,main="Histogram \n Total of steps per day",xlab="steps",col = "lightgray")
par(mfrow=c(1,1))
```

## Are there differences in activity patterns between weekdays and weekends?
#differences in activity patterns between weekdays and weekends
```{r}
d=strptime(datos$date,"%Y-%m-%d")
datos <- mutate(datos,habil=factor(isWeekday(d),labels=c("weekend","weekday")))
week=subset(datos,habil=="weekday")
meanweek=ddply(week,~interval,summarise,mean=mean(na.omit(steps)))
weekend=subset(datos,habil=="weekend")
meanweekend=ddply(weekend,~interval,summarise,mean=mean(na.omit(steps)))
plot(meanweek,type="l" ,col="red",main="Time Series\nMean of steps")
lines(meanweekend,col="blue")
legend("topright",legend=c("week","weekend"),cex=0.7,fill=c("red","blue"))
```
